import sympy as sp
import numpy as np
x = sp.symbols('x', real=True)

intervals = [
    (23.0,30.0),
    (30.0,38.0),
    (38.0,46.0),
    (46.0,54.0),
    (54.0,62.0),
    (62.0,69.0),
    (69.0,77.0),
    (77.0,85.0),
    (85.0,93.0),
    (93.0,101.0),
    (101.0,109.0),
    (109.0,116.0),
    (116.0,124.0),
    (124.0,132.0),
    (132.0,140.0),
    (140.0,148.0),
    (148.0,155.0),
    (155.0,163.0),
    (163.0,171.0),
    (171.0,179.0),
    (179.0,187.0),
    (187.0,195.0)
]

upper_padded = [
[0.004397473275024266, -0.3853984450923349, 11.250728862973801, 16.60495626822194],
[0.009765624999999944, -1.03515625, 35.7421875, -278.296875],
[0.0, 0.0, -0.625, 144.75],
[-0.0009765625, 0.142578125, -7.54296875, 256.3359375],
[-0.0009765625, 0.158203125, -9.23046875, 301.8984375],
[0.005102040816326529, -1.002551020408161, 64.60459183673464, -1262.6377551020305],
[-0.0058593749999999445, 1.2753906249999858, -93.189453125, 2380.794921875],
[0.001953124999999889, -0.498046875, 40.958984375, -1000.587890625],
[0.001953125000000111, -0.5292968750000142, 46.271484375, -1226.369140625],
[0.0009765624999999445, -0.2802734375, 25.2919921875, -643.5751953125],
[0.0205078125, -6.3701171875, 657.7255859375, -22519.9384765625],
[-0.4373177842565595, 147.59475218658883, -16588.33819241982, 620941.8250728862],
[0.0048828125, -1.83203125, 227.921875, -9286.6875],
[0.009765625000000111, -3.765625, 482.21875, -20398.25],
[-0.0029296875000001076, 1.20703125, -166.953125, 7847.6875],
[-0.005859374999999889, 2.5078125, -358.90625, 17264.875],
[0.010204081632653107, -4.655612244897968, 705.9056122448987, -35494.010204081525],
[0.025390625000000056, -11.994140625, 1886.279296875, -98696.576171875],
[-0.06250000000000006, 31.515625, -5292.40625, 296050.265625],
[-0.0019531249999999445, 0.970703125, -157.396484375, 8380.505859375],
[-0.021484375, 11.646484375, -2101.923828125, 126406.533203125],
[-0.013671874999999944, 7.763671875, -1469.337890625, 92803.509765625]
]

lower_padded = [
[-0.00031584062196292253, -0.006948493683190893, 0.751822157434602, 110.22667638483988],
[0.00558035714285709, -0.5758928571428572, 18.968750000000004, -83.42857142857144],
[-0.00390625, 0.4921875, -21.109375, 417.78125],
[0.0009765625, -0.158203125, 7.73046875, -7.8984375],
[0.0022321428571428024, -0.3872767857142856, 21.48660714285714, -280.4598214285711],
[-0.0071064139941691105, 1.3830174927113772, -90.33764577259439, 2073.27223032068],
[0.0022321428571429117, -0.513392857142871, 37.984375, -819.9375],
[0.001953124999999889, -0.482421875, 38.177734375, -891.072265625],
[0.0009765625000000867, -0.2568359375000142, 20.9951171875, -460.6767578125],
[-0.0068359375, 1.9697265625, -190.4345703125, 6228.7841796875],
[0.019112723214285702, -5.990931919642858, 623.5115792410714, -21508.030831473217],
[-0.008564139941690974, 2.981596209912542, -346.01311953352786, 13409.895043731798],
[-0.29687499999999994, 106.875, -12810.75, 511353.0],
[0.01855468750000011, -7.20703125, 931.453125, -39960.6875],
[-0.001953125000000111, 0.78125, -105.46875, 4892.5],
[0.0020926339285715044, -0.9190848214285694, 132.734375, -6230.9375],
[0.002186588921282817, -0.9938046647230401, 148.67747813410915, -7258.4358600583655],
[0.009905133928571449, -4.678431919642854, 734.5977957589284, -38295.81208147321],
[-0.004882812500000052, 2.5126953125, -431.0068359375, 24679.5380859375],
[-0.10351562499999994, 54.619140625, -9599.044921875, 561954.357421875],
[0.0068359375, -3.8662109375, 731.3876953125, -46167.5517578125],
[5.551115123125783e-17, -0.0859375, 34.703125, -3378.3359375]
]

total_signed = 0.0
total_geom = 0.0

for i, ((a,b), cu, cl) in enumerate(zip(intervals, upper_padded, lower_padded), start=1):
    au, bu, cu_c, du = cu
    al, bl, cl_c, dl = cl
    pu = au*x**3 + bu*x**2 + cu_c*x + du
    pl = al*x**3 + bl*x**2 + cl_c*x + dl
    pd = sp.expand(pu - pl)
    F = sp.expand(sp.integrate(pd, x))
    signed = float(sp.N(F.subs(x, b) - F.subs(x, a), 20))
    total_signed += signed

    print(f"Segment {i}: interval [{a}, {b}]")
    print(f"Upper p_u (x) = {sp.expand(pu)}")
    print(f"Lower p_l (x) = {sp.expand(pl)}")
    print(f"Difference p_d (x) = p_u - p_l = {pd}")
    print(f"Antiderivative F (x) = {F}")
    print(f"âˆ«_{a}^{b} p_d (x) dx = {signed:.12f}")
    print("\n") 

print("="*60)
print(f"TOTAL SIGNED AREA = {total_signed:.12f}")